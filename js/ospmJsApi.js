!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((n="undefined"!=typeof globalThis?globalThis:n||self).ospmJsApi={})}(this,(function(n){"use strict";function t(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function e(n,t,e){return n(e={path:t,exports:{},require:function(n,t){return function(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},e.exports),e.exports}var o,r=t(e((function(n){n.exports=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")},n.exports.__esModule=!0,n.exports.default=n.exports}))),i=e((function(n){function t(e){return n.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},n.exports.__esModule=!0,n.exports.default=n.exports,t(e)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})),a=e((function(n){var t=i.default;n.exports=function(n,e){if("object"!==t(n)||null===n)return n;var o=n[Symbol.toPrimitive];if(void 0!==o){var r=o.call(n,e||"default");if("object"!==t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)},n.exports.__esModule=!0,n.exports.default=n.exports})),u=e((function(n){var t=i.default;n.exports=function(n){var e=a(n,"string");return"symbol"===t(e)?e:e+""},n.exports.__esModule=!0,n.exports.default=n.exports})),c=t(e((function(n){function t(n,t){for(var e=0;t.length>e;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,u(o.key),o)}}n.exports=function(n,e,o){return e&&t(n.prototype,e),o&&t(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n},n.exports.__esModule=!0,n.exports.default=n.exports}))),s=function(){function n(){r(this,n),this.window=window,this.wx=this.window.wx,this.readyState=void 0,this.readyStateFunc={},this.wxConfig=null}return c(n,null,[{key:"getInstance",value:function(){return this.instance||(this.instance=new n),this.instance}}]),n}();s.instance=void 0,function(n){n.SUCCESS="success",n.ERROR="fail"}(o||(o={}));var f=function(){return new Promise((function(n){s.getInstance().window.ospjsBridge?n(s.getInstance().window.ospjsBridge):document.addEventListener("ospjsBridgeReady",(function(){n(s.getInstance().window.ospjsBridge)}),!1)}))},l=function(n,t,e){var r=JSON.parse(n);r&&r.result===o.SUCCESS?t(r):e(r)},d={register:function(){this.optionMenu(),this.pause(),this.resume(),this.titleClick(),this.goBack(),this.networkStatus(),this.networkStatusEvent(),this.nfcDataListener(),this.emit(),this.keyboardState(),this.mobileBottomTabChanged(),console.log("registerJsHandlerName:optionMenu、pause、resume、titleClick、goBack、networkStatus、networkStatusEvent、nfcDataCallBack、keyboardState,mobileBottomTabChanged")},networkStatus:function(){s.getInstance().window.ospjsBridge.registerHandler("networkStatus",(function(n){var t=new Event("networkStatus");n&&Object.assign(t,{status:n}),document.dispatchEvent(t)}))},networkStatusEvent:function(){s.getInstance().window.ospjsBridge.registerHandler("networkStatusEvent",(function(n){var t=new Event("networkStatusEvent"),e=JSON.parse(n);Object.assign(t,{netInfo:e.netInfo,networkConnected:e.networkConnected}),document.dispatchEvent(t)}))},optionMenu:function(){s.getInstance().window.ospjsBridge.registerHandler("optionMenu",(function(n){var t=new Event("optionMenu");n&&Object.assign(t,{data:n}),document.dispatchEvent(t)}))},pause:function(){s.getInstance().window.ospjsBridge.registerHandler("pause",(function(){var n=new Event("pause");document.dispatchEvent(n)}))},resume:function(){s.getInstance().window.ospjsBridge.registerHandler("resume",(function(n){var t=new Event("resume");n&&Object.assign(t,{data:n}),document.dispatchEvent(t)}))},titleClick:function(){s.getInstance().window.ospjsBridge.registerHandler("titleClick",(function(){var n=new Event("titleClick");document.dispatchEvent(n)}))},goBack:function(){s.getInstance().window.ospjsBridge.registerHandler("goBack",(function(){var n=new Event("goBack");document.dispatchEvent(n)}))},emit:function(){s.getInstance().window.ospjsBridge.registerHandler("emit",(function(n){var t=new Event("eventSubscribeListener");n&&Object.assign(t,{data:n}),document.dispatchEvent(t)}))},nfcDataListener:function(){s.getInstance().window.ospjsBridge.registerHandler("nfcDataCallBack",(function(n){var t=new Event("nfcDataListener");n&&Object.assign(t,{data:n}),document.dispatchEvent(t)}))},keyboardState:function(){s.getInstance().window.ospjsBridge.registerHandler("keyboardState",(function(n){var t=new Event("keyboardState");n&&Object.assign(t,{data:n}),document.dispatchEvent(t)}))},mobileBottomTabChanged:function(){s.getInstance().window.ospjsBridge.registerHandler("mobileBottomTabChanged",(function(n){var t=new Event("mobileBottomTabChanged");n&&Object.assign(t,{data:n}),document.dispatchEvent(t)}))}},p=function(){var n=navigator.userAgent.match(/MicroMessenger/i);return null!=n&&(null==n?void 0:n.length)>0&&s.getInstance().wx},g=function(){var n=navigator.userAgent.match(/OSPMobile/i);return null!=n&&(null==n?void 0:n.length)>0||!!p()},S=function(){return!!navigator.userAgent.match(/Android/i)},w=function(){return!!navigator.userAgent.match(/iPhone|iPad|iPod/i)},h={config:function(n){return new Promise((function(t,e){f().then((function(o){o.call("ApiSecurity",n,(function(n){return l(n,t,e)}))}))}))}},m={sendWebHttpLog:function(n){return new Promise((function(t){f().then((function(e){e.call("sendWebHttpLog",n,(function(){t({result:o.SUCCESS,data:"操作成功"})}))}))}))},sendHandlePerformanceTimingLog:function(n){return new Promise((function(t){f().then((function(e){e.call("sendHandlePerformanceTimingLog",n,(function(){t({result:o.SUCCESS,data:"操作成功"})}))}))}))}},v={picker:function(n){return new Promise((function(t,e){f().then((function(o){o.call("filePicker",n,(function(n){return l(n,t,e)}))}))}))},filePreview:function(n){return new Promise((function(t,e){f().then((function(o){o.call("filePreview",n,(function(n){return l(n,t,e)}))}))}))},download:function(n){return new Promise((function(t,e){f().then((function(o){o.call("download",n,(function(n){return l(n,t,e)}))}))}))},saveImage:function(n){return new Promise((function(t,e){f().then((function(o){o.call("saveImage",n,(function(n){return l(n,t,e)}))}))}))}},b={barControl:function(n){return new Promise((function(t,e){f().then((function(o){o.call("statusBarControl",n,(function(n){return l(n,t,e)}))}))}))},getStatusBarData:function(n){return new Promise((function(t,e){f().then((function(o){o.call("statusBar",{type:n},(function(n){return l(n,t,e)}))}))}))},getStatusBarHeight:function(){return this.getStatusBarData("getHeight")},isImmersion:function(){return this.getStatusBarData("isImmersion")},setOptionMenu:function(n){return new Promise((function(t,e){f().then((function(o){o.call("optionMenu",n,(function(n){return l(n,t,e)}))}))}))},showOptionMenu:function(){return new Promise((function(n,t){f().then((function(e){e.call("showOptionMenu",{},(function(e){return l(e,n,t)}))}))}))},hideOptionMenu:function(){return new Promise((function(n,t){f().then((function(e){e.call("hideOptionMenu",{},(function(e){return l(e,n,t)}))}))}))}},y={database:function(n,t){return new Promise((function(e,o){f().then((function(r){Object.assign(t,{type:n}),r.call("database",t,(function(n){return l(n,e,o)}))}))}))},openDatabase:function(n){return this.database("openDatabase",n)},isOpen:function(n){return this.database("isOpen",n)},closeDatabase:function(n){return this.database("closeDatabase",n)},transaction:function(n){return this.database("transaction",n)},executeSql:function(n){return this.database("executeSql",n)},simpleExecuteSql:function(n){return this.database("simpleExecuteSql",n)},selectSql:function(n){return this.database("selectSql",n)},simpleSelectSql:function(n){return this.database("simpleSelectSql",n)}},P=new(function(){function n(){r(this,n)}return c(n,[{key:"dataStorage",value:function(n,t){return new Promise((function(e,o){f().then((function(r){Object.assign(t,{type:n}),r.call("dataStorage",t,(function(n){return l(n,e,o)}))}))}))}},{key:"setData",value:function(n){return this.dataStorage("setData",n)}},{key:"getData",value:function(n){return this.dataStorage("getData",n)}},{key:"removeData",value:function(n){return this.dataStorage("removeData",n)}}]),n}()),C={handlerWebScan:function(){return new Promise((function(n,t){f().then((function(e){e.call("handlerWebScan",{},(function(e){var r=JSON.parse(e);r&&r.result===o.SUCCESS?n(r):t(r)}))}))}))},voiceRecognition:function(){return new Promise((function(n,t){f().then((function(e){e.call("voiceRecognition",{},(function(e){var r=JSON.parse(e);r&&r.result===o.SUCCESS?n(r):t(r)}))}))}))},webGPS:function(){return new Promise((function(n,t){f().then((function(e){e.call("webGPS",{},(function(e){var r=JSON.parse(e);r&&r.result===o.SUCCESS?n(r):t(r)}))}))}))},pushWindow:function(n){return new Promise((function(t,e){f().then((function(r){r.call("pushWindow",n,(function(n){var r=JSON.parse(n);r&&r.result===o.SUCCESS?t(r):e(r)}))}))}))},popWindow:function(n){return new Promise((function(t,e){f().then((function(r){r.call("popWindow",n,(function(n){var r=JSON.parse(n);r&&r.result===o.SUCCESS?t(r):e(r)}))}))}))},popTo:function(n){return new Promise((function(t,e){f().then((function(r){r.call("popTo",n,(function(n){var r=JSON.parse(n);r&&r.result===o.SUCCESS?t(r):e(r)}))}))}))},controlNativeBack:function(n){return new Promise((function(t,e){f().then((function(r){r.call("controlNativeBack",n,(function(n){var r=JSON.parse(n);r&&r.result===o.SUCCESS?t(r):e(r)}))}))}))},navigateBack:function(n){return new Promise((function(t,e){f().then((function(r){r.call("navigateBack",n,(function(n){var r=JSON.parse(n);r&&r.result===o.SUCCESS?t(r):e(r)}))}))}))},webCheckAPP:function(n){return new Promise((function(t,e){f().then((function(r){r.call("webCheckAPP",n,(function(n){var r=JSON.parse(n);r&&r.result===o.SUCCESS?t(r):e(r)}))}))}))},getInfo:function(){return new Promise((function(n,t){f().then((function(e){e.call("deviceInfo",{},(function(e){l(e,n,t)}))}))}))},setWebLoading:function(n){return new Promise((function(t,e){f().then((function(o){o.call("WebDialog",{isShow:n},(function(n){l(n,t,e)}))}))}))},screenChange:function(n){return new Promise((function(t,e){f().then((function(o){o.call("screenChange",n,(function(n){l(n,t,e)}))}))}))},cacheManage:function(){return new Promise((function(n,t){f().then((function(e){e.call("cacheManage",{},(function(e){l(e,n,t)}))}))}))},screenState:function(){return new Promise((function(n,t){f().then((function(e){e.call("screenState",{},(function(e){l(e,n,t)}))}))}))}},O=e((function(n){n.exports=function(n,t,e){return(t=u(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n},n.exports.__esModule=!0,n.exports.default=n.exports})),E=e((function(n){function t(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,o)}return e}n.exports=function(n){for(var e=1;arguments.length>e;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?t(Object(o),!0).forEach((function(t){O(n,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(o,t))}))}return n},n.exports.__esModule=!0,n.exports.default=n.exports})),x=t(E),j={open:function(n){return p()?(t=["scanQRCode"],e=function(t,e){s.getInstance().wx.scanQRCode({needResult:n.isSelfHandler?1:0,scanType:["qrCode","barCode"],success:function(n){l(JSON.stringify({result:o.SUCCESS,data:n.resultStr}),t,e)},fail:function(){l(JSON.stringify({result:o.ERROR,data:""}),t,e)},cancel:function(){l(JSON.stringify({result:o.ERROR,data:""}),t,e)}})},new Promise((function(n,r){s.getInstance().wx.config(x(x({},s.getInstance().wxConfig),{},{jsApiList:t})),s.getInstance().wx.ready((function(){e(n,r)})),s.getInstance().wx.error((function(n){r({result:o.ERROR,data:n.errMsg})}))}))):new Promise((function(t,e){f().then((function(o){o.call("openScan",n,(function(n){return l(n,t,e)}))}))}));var t,e}},k={wx:function(n){return new Promise((function(t,e){f().then((function(o){o.call("WxPay",n,(function(n){return l(n,t,e)}))}))}))},ali:function(n){return new Promise((function(t,e){f().then((function(o){o.call("AliPay",n,(function(n){return l(n,t,e)}))}))}))}},I={open:function(n){return new Promise((function(t,e){f().then((function(o){o.call("WebShare",n,(function(n){return l(n,t,e)}))}))}))}},B={send:function(n){return new Promise((function(t,e){f().then((function(o){o.call("WebEvent",n,(function(n){return l(n,t,e)}))}))}))}},M={isConnected:function(){return new Promise((function(n,t){f().then((function(e){e.call("NetworkStatus",{},(function(e){l(e,n,t)}))}))}))}};g()&&f().then((function(){d.register()})),n.apm=m,n.call=function(n,t){return new Promise((function(e,o){f().then((function(r){r.call(n,t,(function(n){return l(n,e,o)}))}))}))},n.config=function(n){s.getInstance().readyState=void 0,h.config(n).then((function(n){s.getInstance().readyState=n,s.getInstance().readyStateFunc.readyFunc&&s.getInstance().readyStateFunc.readyFunc()})).catch((function(n){s.getInstance().readyState=n,s.getInstance().readyStateFunc.errorFunc&&s.getInstance().readyStateFunc.errorFunc(n)})).finally((function(){s.getInstance().readyStateFunc={}}))},n.dataStorage=P,n.device=C,n.error=function(n){var t;s.getInstance().readyState?(null===(t=s.getInstance().readyState)||void 0===t?void 0:t.result)!==o.SUCCESS&&n(s.getInstance().readyState):s.getInstance().readyStateFunc.errorFunc=n},n.event=B,n.initWxConfig=function(n){s.getInstance().wxConfig=n},n.isAndroidEnv=S,n.isMobileEnv=function(){return S()||w()},n.isOSPMobileEnv=g,n.isiOSEnv=w,n.media=v,n.navBar=b,n.netWork=M,n.pay=k,n.ready=function(n){var t;s.getInstance().readyState?(null===(t=s.getInstance().readyState)||void 0===t?void 0:t.result)===o.SUCCESS&&n():s.getInstance().readyStateFunc.readyFunc=n},n.request=function(n){return new Promise((function(t,e){f().then((function(o){o.call("WebRequest",n,(function(n){return l(n,t,e)}))}))}))},n.scan=j,n.security=h,n.share=I,n.sqlite=y,Object.defineProperty(n,"__esModule",{value:!0})}));
